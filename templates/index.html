<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LessonGenie - AI Exam Tutor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f9fafb; }
        .premium-card { background-color: white; border-radius: 12px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05); border: 1px solid #e5e7eb; }
        .prose code::before, .prose code::after { content: "" !important; }
        .prose code { background-color: #eef2ff; color: #4338ca; padding: 0.1em 0.4em; border-radius: 4px; font-size: 0.9em; }
        .timeline-item::before { content: ''; position: absolute; left: 19px; top: 40px; bottom: 0; width: 2px; background-color: #e5e7eb; z-index: 0; }
        .timeline-item:last-child::before { display: none; }
        .timeline-icon { z-index: 1; }
        .timeline-step-header { background-color: #e0e7ff; border-left: 3px solid #4f46e5; padding: 8px 16px; margin-left: -16px; margin-right: -16px; border-radius: 4px 4px 0 0; }
        .timeline-step-content { padding: 16px; background-color: white; border-radius: 0 0 4px 4px; border: 1px solid #e5e7eb; border-top: none; margin-left: -16px; margin-right: -16px; margin-top: -1px; }
        .step-appear { opacity: 0; transform: translateY(10px); animation: stepFadeIn 0.5s ease-out forwards; }
        @keyframes stepFadeIn { to { opacity: 1; transform: translateY(0); } }
        /* Add hidden class definition if not relying solely on Tailwind */
        .hidden { display: none; }
    </style>
</head>
<body class="text-gray-800">
    <div class="min-h-screen flex flex-col">
        <header class="bg-white shadow-sm sticky top-0 z-20 border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
                <h1 class="text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600">LessonGenie</h1>
            </div>
        </header>

        <main class="flex-grow w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 md:py-12">

            <!-- === Upload Section === -->
            <div id="upload-section" class="premium-card p-8 md:p-10 mb-10">
                <h2 class="text-3xl font-bold mb-2 text-gray-800">1. Upload Your Exam</h2>
                <p class="text-lg text-gray-500 mb-8">Upload your exam PDF. We'll extract the questions for you.</p>

                <form id="lesson-form">
                    <div class="mb-6">
                        <label for="pdf-file" class="block text-sm font-medium text-gray-700 mb-2">Select Exam PDF:</label>
                        <input type="file" id="pdf-file" name="pdf_file" accept="application/pdf" required
                               class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 cursor-pointer border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>

                    <button type="submit" id="generate-button"
                            class="w-full inline-flex justify-center items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 disabled:opacity-50 disabled:cursor-not-allowed">
                        <svg id="button-loading-spinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"> <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle> <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path> </svg>
                        <span id="button-text">Extract Questions</span> <!-- Changed Text -->
                    </button>
                </form>
                 <!-- Corrected ID -->
                 <div id="upload-error-message" class="mt-4 p-4 bg-red-100 border border-red-300 text-red-700 rounded-md text-sm hidden"></div>
            </div>

             <!-- === Question List Section (Initially Hidden) === -->
            <div id="question-list-section" class="premium-card p-8 md:p-10 mb-10 hidden">
                 <button onclick="resetUI()" class="mb-6 inline-flex items-center text-sm font-semibold text-indigo-600 hover:text-indigo-800 transition duration-150">
                     <svg class="w-5 h-5 mr-1.5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                    Upload Different PDF
                </button>
                <h2 class="text-3xl font-bold mb-2 text-gray-800">2. Select a Question</h2>
                <p class="text-lg text-gray-500 mb-8">Click on a question below to get a detailed explanation.</p>
                 <!-- Corrected ID -->
                 <div id="question-list-loading" class="text-center text-indigo-600 font-medium mt-8 animate-pulse hidden">Loading questions...</div>
                 <!-- Corrected ID -->
                <ul id="extracted-questions" class="space-y-4">
                    <!-- Question list items will be dynamically added here by JS -->
                </ul>
                 <!-- Corrected ID -->
                 <div id="lesson-error-message" class="mt-6 p-4 bg-red-100 border border-red-300 text-red-700 rounded-md text-sm hidden"></div>
            </div>

            <!-- === Lesson Display Section (Initially Hidden) === -->
            <div id="lesson-section" class="hidden">
                 <button id="back-to-questions-button" onclick="showQuestionList(); hideLesson();" class="mb-6 inline-flex items-center text-sm font-semibold text-indigo-600 hover:text-indigo-800 transition duration-150">
                     <svg class="w-5 h-5 mr-1.5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                    Back to Question List
                </button>
                 <button id="back-to-upload-button" onclick="resetUI()" class="mb-6 ml-4 inline-flex items-center text-sm font-semibold text-gray-600 hover:text-gray-800 transition duration-150">
                     <svg class="w-5 h-5 mr-1.5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3" /></svg>
                    Start Over (New PDF)
                </button>

                 <div class="premium-card">
                     <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-6 md:p-8 rounded-t-xl">
                        <h2 id="lesson-title" class="text-3xl md:text-4xl font-bold text-white mb-2 leading-tight"></h2>
                        <p id="lesson-subheader" class="text-indigo-100 text-sm font-medium"></p>
                     </div>
                     <div class="p-6 md:p-8">
                         <!-- Corrected ID -->
                         <div id="lesson-loading" class="text-center text-indigo-600 font-medium my-8 animate-pulse hidden">Generating your detailed lesson...</div>
                         <div id="lesson-content-area"> <!-- Wrapper added -->
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 lg:gap-12">
                                <div class="lg:col-span-2 space-y-10">
                                    <div> <h3 class="text-xl font-semibold mb-4 flex items-center text-gray-700"><svg class="w-6 h-6 mr-2 text-blue-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>Understanding the Concept</h3> <div id="lesson-concept" class="prose prose-indigo max-w-none prose-sm md:prose-base mt-2"></div> </div>
                                    <div> <h3 class="text-xl font-semibold mb-6 flex items-center text-gray-700"><svg class="w-6 h-6 mr-2 text-green-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>Step-by-Step Solution</h3> <div id="lesson-steps-timeline" class="space-y-6 relative"></div> </div>
                                </div>
                                <div class="lg:col-span-1 space-y-8">
                                    <div id="lesson-image-container" class="hidden"> <h4 class="text-lg font-semibold mb-3 text-gray-700">Visual Aid</h4> <div id="lesson-image-placeholder" class="bg-gray-100 aspect-video w-full rounded-lg flex flex-col items-center justify-center text-gray-400 border border-gray-200 shadow-inner p-4 text-center"> <svg class="w-10 h-10 mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" /></svg> <span class="text-sm">A relevant visual was identified.</span> <span class="text-xs mt-1">(Rendering not implemented)</span> </div> </div>
                                    <div id="lesson-hints-container" class="hidden"> <div class="bg-yellow-50 border border-yellow-200 p-5 rounded-lg shadow-sm"> <h4 class="text-lg font-semibold mb-3 flex items-center text-yellow-900"><svg class="w-5 h-5 mr-2 text-yellow-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.355a11.998 11.998 0 01-4.5 0m-7.5-11.978a12.049 12.049 0 014.5 0m-4.5 0a12.048 12.048 0 00-1.605 5.493a1.5 1.5 0 001.605 1.5H6a1.5 1.5 0 001.605-1.5c-.168-1.988-.747-3.829-1.605-5.493M18 12a12.048 12.048 0 01-1.605 5.493A1.5 1.5 0 0118 19.5h.008a1.5 1.5 0 011.605-1.5c.858 1.664 1.437 3.505 1.605 5.493m0-11.978a12.049 12.049 0 00-4.5 0m4.5 0a12.048 12.048 0 011.605 5.493a1.5 1.5 0 01-1.605 1.5H18a1.5 1.5 0 01-1.605-1.5c.168-1.988.747-3.829 1.605-5.493" /></svg>Key Hints & Reminders</h4> <ul id="lesson-hints" class="prose prose-sm prose-yellow max-w-none text-yellow-800 ml-1 space-y-1 list-disc list-inside"></ul> </div> </div>
                                </div>
                            </div>
                         </div> <!-- End lesson-content-area -->
                     </div>
                 </div>
            </div>

        </main>

        <footer class="text-center p-5 text-xs text-gray-500 mt-auto border-t border-gray-200 bg-white">
            LessonGenie &copy; 2024 - AI Exam Tutor
        </footer>
    </div>

    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script src="/static/js/script.js"></script>
</body>
</html>
